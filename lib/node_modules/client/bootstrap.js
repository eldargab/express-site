$(function () {
    $.ajaxSetup({
        headers: {
            'X-Requested-With': 'XMLHttpRequest'
        }
    });

    var browser = require('browser');
    var Site = require('site');

    var site = new Site($('#page-container').first());

    browser.onnavigate = function () {
        site.setPage(browser.getUrl());
    }

    $(window).on('click', 'a', function (e) {
        e.preventDefault();
        if (this.pathname == browser.getUrl()) return;
        browser.navigate(this.pathname);
    });

    browser.history.start();
});
