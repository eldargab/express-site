var P = require('ports');

module.exports = Field;

function Field (initialValue) {
    var f = P.isPort(initialValue) ? initialValue : P.property(initialValue);
    f.msg = Msg();

    f.reset = function () {
        f.msg.clear();
        f(initialValue);
    }

    f.hasError = P.computable(function () {
        return f.msg.type() == 'error';
    }, f.msg.type);

    f.isField = true;
    return f;
}

function Msg () {
    function msg (type, text) {
        msg.type(type);
        msg.text(text);
    }

    msg.clear = function () {
        msg.type('');
        msg.text('');
    }

    msg.type = P.property('');
    msg.text = P.property('');

    return msg;
}

