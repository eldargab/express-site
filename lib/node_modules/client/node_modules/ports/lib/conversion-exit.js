var P = require('./port');

module.exports = function (output, input) {
    return function filter (port) {
        function setter (val) {
            port(input(val));
        }

        function getter () {
            return output(port()); 
        }

        if (port.listen) {
            var events = Object.create(Backbone.Events);
            port.listen(events.trigger.bind(events, 'change'));
            return P.createListenable(setter, getter, events);
        }
        return P.create(setter, getter);
    }
}
